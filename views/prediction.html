<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <a href="/" class="btn btn-outline-secondary mb-4">❮ Quay lại Trang chủ</a>
        <h1 class="text-center mb-2"><%= title %></h1>
        <p class="text-center text-muted mb-4">Phân tích tần suất các số xuất hiện vào ngày hôm sau, dựa trên số đã về của ngày hôm trước (chế độ Lô).</p>
        
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <form id="predictionForm" class="row g-3 align-items-end">
                    <div class="col-md-4">
                        <label for="numberInput" class="form-label fw-bold">Nhập số cần phân tích (00-99):</label>
                        <input type="text" class="form-control form-control-lg" id="numberInput" name="number" value="<%= inputNumber %>" maxlength="2" pattern="\\d{1,2}" placeholder="Ví dụ: 68">
                    </div>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-primary btn-lg">Phân tích</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <strong>Kết quả Phân tích</strong>
            </div>
            <div class="card-body">
                <p class="alert alert-info"><%= message %></p>
                <% if (results && results.length > 0) { %>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>#</th>
                                    <th>Số về hôm sau</th>
                                    <th>Số lần xuất hiện</th>
                                    <th>Tần suất</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% results.forEach((item, index) => { %>
                                    <tr>
                                        <td><%= index + 1 %></td>
                                        <td><span class="badge bg-danger fs-5"><%= item.number %></span></td>
                                        <td><%= item.count %> lần</td>
                                        <td>
                                            <div class="progress" style="height: 20px;">
                                                <div class="progress-bar" role="progressbar" style="width: <%= item.percentage %>%;" aria-valuenow="<%= item.percentage %>" aria-valuemin="0" aria-valuemax="100"><%= item.percentage %>%</div>
                                            </div>
                                        </td>
                                    </tr>
                                <% }) %>
                            </tbody>
                        </table>
                    </div>
                <% } %>
            </div>
        </div>
    </div>
    <script>
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const number = document.getElementById('numberInput').value;
            if (number) {
                window.location.href = `/prediction?number=${number}`;
            } else {
                 window.location.href = `/prediction`;
            }
        });
    </script>
</body>
</html>
